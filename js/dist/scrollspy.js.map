{"version":3,"file":"scrollspy.js","sources":["../src/scrollspy.js"],"sourcesContent":["/**\n * --------------------------------------------------------------------------\n * Vira Design System (v1.0.0): scrollspy.js\n * Licensed under MIT (https://github.com/Victin09/vira-design-system/blob/main/LICENSE)\n * --------------------------------------------------------------------------\n */\n\nimport { defineJQueryPlugin, getElement, getSelectorFromElement } from './util/index'\nimport EventHandler from './dom/event-handler'\nimport Manipulator from './dom/manipulator'\nimport SelectorEngine from './dom/selector-engine'\nimport BaseComponent from './base-component'\n\n/**\n * Constants\n */\n\nconst NAME = 'scrollspy'\nconst DATA_KEY = 'vds.scrollspy'\nconst EVENT_KEY = `.${DATA_KEY}`\nconst DATA_API_KEY = '.data-api'\n\nconst EVENT_ACTIVATE = `activate${EVENT_KEY}`\nconst EVENT_SCROLL = `scroll${EVENT_KEY}`\nconst EVENT_LOAD_DATA_API = `load${EVENT_KEY}${DATA_API_KEY}`\n\nconst CLASS_NAME_DROPDOWN_ITEM = 'dropdown-item'\nconst CLASS_NAME_ACTIVE = 'active'\n\nconst SELECTOR_DATA_SPY = '[data-vds-spy=\"scroll\"]'\nconst SELECTOR_NAV_LIST_GROUP = '.nav, .list-group'\nconst SELECTOR_NAV_LINKS = '.nav-link'\nconst SELECTOR_NAV_ITEMS = '.nav-item'\nconst SELECTOR_LIST_ITEMS = '.list-group-item'\nconst SELECTOR_LINK_ITEMS = `${SELECTOR_NAV_LINKS}, ${SELECTOR_LIST_ITEMS}, .${CLASS_NAME_DROPDOWN_ITEM}`\nconst SELECTOR_DROPDOWN = '.dropdown'\nconst SELECTOR_DROPDOWN_TOGGLE = '.dropdown-toggle'\n\nconst METHOD_OFFSET = 'offset'\nconst METHOD_POSITION = 'position'\n\nconst Default = {\n  offset: 10,\n  method: 'auto',\n  target: ''\n}\n\nconst DefaultType = {\n  offset: 'number',\n  method: 'string',\n  target: '(string|element)'\n}\n\n/**\n * Class definition\n */\n\nclass ScrollSpy extends BaseComponent {\n  constructor(element, config) {\n    super(element, config)\n    this._scrollElement = this._element.tagName === 'BODY' ? window : this._element\n    this._offsets = []\n    this._targets = []\n    this._activeTarget = null\n    this._scrollHeight = 0\n\n    EventHandler.on(this._scrollElement, EVENT_SCROLL, () => this._process())\n\n    this.refresh()\n    this._process()\n  }\n\n  // Getters\n  static get Default() {\n    return Default\n  }\n\n  static get DefaultType() {\n    return DefaultType\n  }\n\n  static get NAME() {\n    return NAME\n  }\n\n  // Public\n  refresh() {\n    this._offsets = []\n    this._targets = []\n    this._scrollHeight = this._getScrollHeight()\n\n    const autoMethod = this._scrollElement === this._scrollElement.window ? METHOD_OFFSET : METHOD_POSITION\n    const offsetMethod = this._config.method === 'auto' ? autoMethod : this._config.method\n    const offsetBase = offsetMethod === METHOD_POSITION ? this._getScrollTop() : 0\n    const targets = SelectorEngine.find(SELECTOR_LINK_ITEMS, this._config.target)\n      .map(element => {\n        const targetSelector = getSelectorFromElement(element)\n        const target = targetSelector ? SelectorEngine.findOne(targetSelector) : null\n\n        if (!target) {\n          return null\n        }\n\n        const targetBCR = target.getBoundingClientRect()\n\n        return targetBCR.width || targetBCR.height ?\n          [Manipulator[offsetMethod](target).top + offsetBase, targetSelector] :\n          null\n      })\n        .filter(Boolean)\n        .sort((a, b) => a[0] - b[0])\n\n    for (const target of targets) {\n      this._offsets.push(target[0])\n      this._targets.push(target[1])\n    }\n  }\n\n  dispose() {\n    EventHandler.off(this._scrollElement, EVENT_KEY)\n    super.dispose()\n  }\n\n  // Private\n\n  _configAfterMerge(config) {\n    config.target = getElement(config.target) || document.documentElement\n\n    return config\n  }\n\n  _getScrollTop() {\n    return this._scrollElement === window ?\n      this._scrollElement.pageYOffset :\n      this._scrollElement.scrollTop\n  }\n\n  _getScrollHeight() {\n    return this._scrollElement.scrollHeight || Math.max(\n      document.body.scrollHeight,\n      document.documentElement.scrollHeight\n    )\n  }\n\n  _getOffsetHeight() {\n    return this._scrollElement === window ?\n      window.innerHeight :\n      this._scrollElement.getBoundingClientRect().height\n  }\n\n  _process() {\n    const scrollTop = this._getScrollTop() + this._config.offset\n    const scrollHeight = this._getScrollHeight()\n    const maxScroll = this._config.offset + scrollHeight - this._getOffsetHeight()\n\n    if (this._scrollHeight !== scrollHeight) {\n      this.refresh()\n    }\n\n    if (scrollTop >= maxScroll) {\n      const target = this._targets[this._targets.length - 1]\n\n      if (this._activeTarget !== target) {\n        this._activate(target)\n      }\n\n      return\n    }\n\n    if (this._activeTarget && scrollTop < this._offsets[0] && this._offsets[0] > 0) {\n      this._activeTarget = null\n      this._clear()\n      return\n    }\n\n    for (const i of this._offsets.keys()) {\n      const isActiveTarget = this._activeTarget !== this._targets[i] &&\n          scrollTop >= this._offsets[i] &&\n          (typeof this._offsets[i + 1] === 'undefined' || scrollTop < this._offsets[i + 1])\n\n      if (isActiveTarget) {\n        this._activate(this._targets[i])\n      }\n    }\n  }\n\n  _activate(target) {\n    this._activeTarget = target\n\n    this._clear()\n\n    const queries = SELECTOR_LINK_ITEMS.split(',')\n      .map(selector => `${selector}[data-vds-target=\"${target}\"],${selector}[href=\"${target}\"]`)\n\n    const link = SelectorEngine.findOne(queries.join(','), this._config.target)\n\n    link.classList.add(CLASS_NAME_ACTIVE)\n    if (link.classList.contains(CLASS_NAME_DROPDOWN_ITEM)) {\n      SelectorEngine.findOne(SELECTOR_DROPDOWN_TOGGLE, link.closest(SELECTOR_DROPDOWN))\n        .classList.add(CLASS_NAME_ACTIVE)\n    } else {\n      for (const listGroup of SelectorEngine.parents(link, SELECTOR_NAV_LIST_GROUP)) {\n        // Set triggered links parents as active\n        // With both <ul> and <nav> markup a parent is the previous sibling of any nav ancestor\n        for (const item of SelectorEngine.prev(listGroup, `${SELECTOR_NAV_LINKS}, ${SELECTOR_LIST_ITEMS}`)) {\n          item.classList.add(CLASS_NAME_ACTIVE)\n        }\n\n        // Handle special case when .nav-link is inside .nav-item\n        for (const navItem of SelectorEngine.prev(listGroup, SELECTOR_NAV_ITEMS)) {\n          for (const item of SelectorEngine.children(navItem, SELECTOR_NAV_LINKS)) {\n            item.classList.add(CLASS_NAME_ACTIVE)\n          }\n        }\n      }\n    }\n\n    EventHandler.trigger(this._scrollElement, EVENT_ACTIVATE, {\n      relatedTarget: target\n    })\n  }\n\n  _clear() {\n    const activeNodes = SelectorEngine.find(SELECTOR_LINK_ITEMS, this._config.target)\n      .filter(node => node.classList.contains(CLASS_NAME_ACTIVE))\n\n    for (const node of activeNodes) {\n      node.classList.remove(CLASS_NAME_ACTIVE)\n    }\n  }\n\n  // Static\n  static jQueryInterface(config) {\n    return this.each(function () {\n      const data = ScrollSpy.getOrCreateInstance(this, config)\n\n      if (typeof config !== 'string') {\n        return\n      }\n\n      if (typeof data[config] === 'undefined') {\n        throw new TypeError(`No method named \"${config}\"`)\n      }\n\n      data[config]()\n    })\n  }\n}\n\n/**\n * Data API implementation\n */\n\nEventHandler.on(window, EVENT_LOAD_DATA_API, () => {\n  for (const spy of SelectorEngine.find(SELECTOR_DATA_SPY)) {\n    new ScrollSpy(spy) // eslint-disable-line no-new\n  }\n})\n\n/**\n * jQuery\n */\n\ndefineJQueryPlugin(ScrollSpy)\n\nexport default ScrollSpy\n"],"names":["NAME","DATA_KEY","EVENT_KEY","DATA_API_KEY","EVENT_ACTIVATE","EVENT_SCROLL","EVENT_LOAD_DATA_API","CLASS_NAME_DROPDOWN_ITEM","CLASS_NAME_ACTIVE","SELECTOR_DATA_SPY","SELECTOR_NAV_LIST_GROUP","SELECTOR_NAV_LINKS","SELECTOR_NAV_ITEMS","SELECTOR_LIST_ITEMS","SELECTOR_LINK_ITEMS","SELECTOR_DROPDOWN","SELECTOR_DROPDOWN_TOGGLE","METHOD_OFFSET","METHOD_POSITION","Default","offset","method","target","DefaultType","ScrollSpy","BaseComponent","constructor","element","config","_scrollElement","_element","tagName","window","_offsets","_targets","_activeTarget","_scrollHeight","EventHandler","on","_process","refresh","_getScrollHeight","autoMethod","offsetMethod","_config","offsetBase","_getScrollTop","targets","SelectorEngine","find","map","targetSelector","getSelectorFromElement","findOne","targetBCR","getBoundingClientRect","width","height","Manipulator","top","filter","Boolean","sort","a","b","push","dispose","off","_configAfterMerge","getElement","document","documentElement","pageYOffset","scrollTop","scrollHeight","Math","max","body","_getOffsetHeight","innerHeight","maxScroll","length","_activate","_clear","i","keys","isActiveTarget","queries","split","selector","link","join","classList","add","contains","closest","listGroup","parents","item","prev","navItem","children","trigger","relatedTarget","activeNodes","node","remove","jQueryInterface","each","data","getOrCreateInstance","TypeError","spy","defineJQueryPlugin"],"mappings":"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"}